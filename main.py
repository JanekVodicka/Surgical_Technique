from pathlib import Pathfrom docxtpl import DocxTemplatefrom tkinter import filedialogfrom tkinter import *import sys# Vlastní skriptyimport vario# Kam se dokument uloží?root = Tk()root.withdraw()folder = filedialog.askdirectory()print("Selected folder: ", folder)document_path = Path(__file__).parent / "02_STCMXXYYYY_SURGICAL TECHNIQUE.docx"doc = DocxTemplate(document_path)# Připojení k Variucase_ID = input("Case_ID: ")data = vario.connect_to_vario(case_ID)""" GENEROVÁNÍ DOKUMENTŮ """patient_ID = data["u_IDPacienta"]def fill_surg_tech():    bool_resection = False    bool_peg = False    bool_peg_9 = False    bool_peg_10 = False    bool_screws_cort = False    bool_screws_cort_4_5 = False    bool_screws_cort_3_5 = False    bool_screws_canc = False    bool_screws_canc_6_5 = False    bool_screws_canc_4 = False    num_screws_cort_3_5 = "0"    num_screws_cort_4_5 = "0"    num_screws_canc_4 = "0"    num_screws_canc_6_5 = "0"    num_cutting_planes = "0"    safe_margins = "0"    surgical_approach = "0"    num_kwires = "0"    peg_reamer_diameter = "0"    peg_reaming_distance = "0"    strana = data["u_Strana"]    if strana == "Pravá":        side = "RIGHT"    elif strana == "LEVÁ":        side = "LEFT"    else:        side = ""    prescriber = data["u_Lekar"]    autor = data["Referent"]    resection_planned = input("Resection_planned [y/n]: ")    peg = input("PEG [y/n] :")    num_screws_cort = input("Number of cortical screws: ")    num_screws_canc = input("Number of cancellous screws: ")    if resection_planned == "y":        bool_resection = True        num_cutting_planes = input("Number of cutting planes: ")        safe_margins = input("Safe_margins [mm]: ")        surgical_approach = input("Surgical approach: ")        num_kwires = input("Number of K-wires: ")    if peg == "y":        bool_peg = True        peg_reamer_diameter = input("PEG diameter [9,10]: ")        peg_reaming_dist = input("PEG reamin distance [mm]: ")        if peg_reamer_diameter == "9":            bool_peg_9 = True        elif peg_reamer_diameter == "10":            bool_peg_10 = True    if num_screws_cort > "0":        bool_screws_cort = True        num_screws_cort_3_5 = input("Number of cortical screws 3,5mm: ")        num_screws_cort_4_5 = input("Number of cortical screws 4,5mm: ")        if num_screws_cort_3_5 > "0":            bool_screws_cort_3_5 = True        if num_screws_cort_4_5 > "0":            bool_screws_cort_4_5 = True    if num_screws_canc > "0":        bool_screws_canc = True        num_screws_canc_4 = input("Number of cancallous screws 4mm: ")        num_screws_canc_6_5 = input("Number of cancallous screws 6,5mm: ")        if num_screws_canc_4 > "0":            bool_screws_canc_4 = True        if num_screws_canc_6_5 > "0":            bool_screws_canc_6_5 = True    context_surg_tech = {        "case_ID": case_ID,        "autor": autor,        "patient_ID": patient_ID,        "prescriber": prescriber,        "side": side,        "num_cut_pl": num_cutting_planes,        "safe_margins": safe_margins,        "surgical_approach": surgical_approach,        "num_kwires": num_kwires,        "display_resection": bool_resection,        "display_paragraph_peg": bool_peg,        "display_paragraph_peg_9": bool_peg_9,        "display_paragraph_peg_10": bool_peg_10,        "display_paragraph_screws_cort": bool_screws_cort,        "display_paragraph_screws_cort_4_5": bool_screws_cort_4_5,        "display_paragraph_screws_cort_3_5": bool_screws_cort_3_5,        "display_paragraph_screws_canc": bool_screws_canc,        "display_paragraph_screws_canc_4": bool_screws_canc_4,        "display_paragraph_screws_canc_6_5": bool_screws_canc_6_5,        "num_screws_cort": num_screws_cort,        "num_screws_canc": num_screws_canc,        "num_screws_cort_4_5": num_screws_cort_3_5,        "num_screws_cort_6_5": num_screws_cort_4_5,        "num_screws_canc_4": num_screws_canc_4,        "num_screws_canc_6_5": num_screws_canc_6_5,        "peg_reamer_diameter": peg_reamer_diameter,        "peg_reaming_distance": peg_reaming_distance,    }    return context_surg_techdoc.render(fill_surg_tech())doc.save(Path(folder) / "02_ST{}_SURGICAL TECHNIQUE.docx".format(case_ID))